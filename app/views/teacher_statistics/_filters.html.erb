<%
	views ||= []
	views_style ||= {}
	hide ||= []
	hide_dataset = hide.include?(:dataset)
	hide_order = hide.include?(:order)
	hide_limit = hide.include?(:limit)
	
	period = %Q!#{@from.strftime("%Y%m%d")}#{TeacherStatisticsController::Date_Range_Splitter}#{@to.strftime("%Y%m%d")}!
	compare = @compared_from && @compared_from.strftime("%Y%m%d")
	graduation = h(@graduation)
%>


<% form_tag "", :method => :get, :id => "refresh_form" do %>
	<input type="hidden" id="period" name="period" value="<%= period %>" />
	<input type="hidden" id="compare" name="compare" value="<%= compare %>" />
	
	<% unless hide_dataset %>
		<input type="hidden" id="q" name="q" value="<%= "f" unless @q %>" />
		<input type="hidden" id="v" name="v" value="<%= "f" unless @v %>" />
	<% end %>
	
	<input type="hidden" id="view" name="view" value="<%= @view %>" />
	
	<input type="hidden" id="level" name="level" value="<%= @level && @level[:id] %>" />
	<input type="hidden" id="graduation" name="graduation" value="<%= graduation %>" />
	<input type="hidden" id="college" name="college" value="<%= @college && @college[:id] %>" />
	<input type="hidden" id="major" name="major" value="<%= @major && @major[:id] %>" />
	<input type="hidden" id="student" name="student" value="<%= @student && @student.id %>" />
	
	<input type="hidden" id="corp" name="corp" value="<%= @corp && @corp.id %>" />
	<input type="hidden" id="domain" name="domain" value="<%= @domain && @domain[:id] %>" />
	<input type="hidden" id="tag" name="tag" value="<%= @tag && @tag[:id] %>" />
	
	<% unless hide_order %>
		<input type="hidden" id="order" name="order" value="<%= @order %>" />
	<% end %>
	<% unless hide_limit %>
		<input type="hidden" id="limit" name="limit" value="<%= @limit %>" />
	<% end %>
<% end %>


<div>
	<table border="0" cellspacing="0" cellpadding="0" class="main_part_w">
		<tr>
			<td style="width: 35px;">时段:</td>
			<td style="width: 250px; height: 30px;">
				<input type="text" id="date_range" class="text_field" style="width: 180px;" />
			</td>

			<td>
				<a href="#" class="none" title="与其他时段进行对比" id="compare_link">
					<img alt="对比" src="/images/teachers/compare_icon.gif" border="0" style="margin: 0px 2px -3px 0px;" />
					对比时段</a>
				<% if @compared_from %>
					<span style="color: #333333; margin-right: 1px;">
						:
						<%= @compared_from.strftime("%y年%m月%d日") %>
					</span>
					<a href="#" title="清除对比" id="remove_compare_link">
						<img alt="清除" src="/images/teachers/delete_icon.gif" border="0" /></a>
				<% end %>
			</td>
			
			<% unless hide_dataset %>
				<td style="width: 35px;" align="right">数据:</td>
				<td style="width: 90px;" align="right">
					<% unless @student %>
						<a href="#" class="none" onclick="change_dataset('q', '<%= "f" if @q %>'); return false;" title="<%= @q ? "隐藏" : "显示" %> <%= @query_dataset_name %>">
					<% end %>
							<img alt="<%= @q ? "隐藏" : "显示" %>" src="/images/teachers/<%= "un" unless @q %>checked_icon.gif" border="0" style="margin-bottom: -2px;" />
							<span style="color: <%= @query_dataset_color %>">
								<%= @query_dataset_name %>
							</span>
					<% unless @student %>
						</a>
					<% end %>
				</td>
				<td style="width: 90px;" align="right">
					<a href="#" class="none" onclick="change_dataset('v', '<%= "f" if @v %>'); return false;" title="<%= @v ? "隐藏" : "显示" %> <%= @view_dataset_name %>">
						<img alt="<%= @v ? "隐藏" : "显示" %>" src="/images/teachers/<%= "un" unless @v %>checked_icon.gif" border="0" style="margin-bottom: -2px;" />
						<span style="color: <%= @view_dataset_color %>">
							<%= @view_dataset_name %>
						</span>
					</a>
				</td>
				<td style="width: 30px;"></td>
			<% end %>
		</tr>
	</table>
</div>


<div style="margin-top: 8px;">
	<table border="0" cellspacing="0" cellpadding="0" class="main_part_w">
		<tr>
			<td style="width: 35px;" valign="top">过滤:</td>
			
			<td style="width: 20px; padding-top: 2px;" valign="top">
				<img alt="过滤" src="/images/teachers/filter_icon.gif" border="0" />
			</td>

			<td>
				<%=
					render_filters(
						[
							["level", "教育水平"],
							["graduation", "毕业时间"],
							["college", "学院"],
							["major", "专业"],
							["student", "学生"]
						]
					)
				%>
			</td>
		</tr>
		
		<tr><td colspan="3" style="height: 5px;"></td></tr>
		
		<tr>
			<td></td>
			
			<td style="width: 20px; padding-top: 2px;" valign="top">
				<img alt="过滤" src="/images/teachers/filter_icon.gif" border="0" />
			</td>

			<td>
				<%=
					render_filters(
						[
							["corp", "企业"],
							["domain", "求职方向"],
							["tag", "经历标签"]
						]
					)
				%>
			</td>
		</tr>
	</table>
</div>


<div style="margin-bottom: 8px;">
	<table border="0" cellspacing="0" cellpadding="0" class="main_part_w">
		<tr>
			<td>&nbsp;</td>
			
			<% unless hide_limit %>
				<td style="width: 35px;">行数:</td>
				<td style="width: 30px;">
					<div id="limit_slider_label"></div>
				</td>
				<td style="width: 200px;">
					<div id="limit_slider"></div>
				</td>
				<td style="width: 30px;"></td>
			<% end %>
			
			<% unless hide_order %>
				<% asc = (@order == "asc") %>
				<td style="width: 35px;">排序:</td>
				<td style="width: 85px;">
					<% if asc %>
						<a href="#" title="改为从多到少" class="none" onclick="change_order('desc'); return false;">
							从少到多
							<img alt="升序" src="/images/teachers/asc_icon.gif" border="0" style="margin-bottom: -1px;" />
						</a>
					<% else %>
						<a href="#" title="改为从少到多" class="none" onclick="change_order('asc'); return false;">
							从多到少
							<img alt="降序" src="/images/teachers/desc_icon.gif" border="0" style="margin-bottom: -1px;" />
						</a>
					<% end %>
				</td>
			<% end %>
			
			<td style="width: 35px;">视图:</td>
			<% views.each do |view| %>
				<td style="width: <%= views_style[:width] || "25" %>px;">
					<a href="#" title="<%= view[1] %>" id="view_link_<%= view[0] %>" class="view_link">
						<img alt="<%= view[1] %>" src="/images/teachers/view_icons/<%= view[0] %>_view<%= "_selected" if view[0] == @view %>_icon.gif" border="0" /></a>
				</td>
			<% end %>
		
			<td style="width: <%= views_style[:right] || "50" %>px;"></td>
		</tr>
	</table>
</div>
